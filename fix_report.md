# 配当表の不整合修正レポート

**修正日時:** 2025年12月11日 06:42  
**問題:** デモページとアンケート後のスロットページでGODの配当が異なる

## 問題の詳細

### 発見された不整合

| シンボル | デモページ（修正前） | アンケート後のスロット | 状態 |
|---------|------------------|-------------------|------|
| GOD | **500点** | 300点 | ❌ 不整合 |
| ７ | 100点 | 100点 | ✓ 一致 |
| BAR | 50点 | 50点 | ✓ 一致 |
| 🔔 | 20点 | 20点 | ✓ 一致 |
| 🍇 | 12点 | 12点 | ✓ 一致 |
| 🍒 | 8点 | 8点 | ✓ 一致 |
| 🍋 | 5点 | 5点 | ✓ 一致 |

## 原因

`static/slot.js`の444行目にあるフォールバックデフォルト値で、GODの配当が500点にハードコードされていました。

```javascript
const defaultSymbols = [
  {id:'GOD', label:'GOD', payout_3:500, color:'#ff8800', prob:0.4079},  // ← 500点
  // ...
];
```

このフォールバック値は、config.jsonの読み込みに失敗した場合に使用されます。デモページでこの値が使用されていたため、配当表に500点と表示されていました。

## 修正内容

### 修正ファイル
- `/home/ubuntu/survey-system-app/static/slot.js`

### 変更内容
```javascript
// 修正前
{id:'GOD', label:'GOD', payout_3:500, color:'#ff8800', prob:0.4079},

// 修正後
{id:'GOD', label:'GOD', payout_3:300, color:'#ff8800', prob:0.4079},
```

### Gitコミット
```
commit 272f927
Fix: GOD payout in demo page fallback (500 -> 300)
```

## 修正後の確認

### デモページ（修正後）

| シンボル | 配当 |
|---------|------|
| GOD | **300点** ✓ |
| ７ | 100点 |
| BAR | 50点 |
| 🔔 | 20点 |
| 🍇 | 12点 |
| 🍒 | 8点 |
| 🍋 | 5点 |

### アンケート後のスロットページ

| シンボル | 配当 |
|---------|------|
| GOD | **300点** ✓ |
| ７ | 100点 |
| BAR | 50点 |
| 🔔 | 20点 |
| 🍇 | 12点 |
| 🍒 | 8点 |
| 🍋 | 5点 |

## 結果

✅ **修正完了**

両ページの配当表が一致しました。GODの配当は300点で統一されています。

## 今後の推奨事項

1. **設定の一元管理**: フォールバック値もconfig.jsonから読み込むように変更
2. **テストの追加**: デモページとアンケート後のスロットページの配当表が一致することを確認するテスト
3. **設定の検証**: 起動時にconfig.jsonの読み込みが成功しているか確認するログを追加
