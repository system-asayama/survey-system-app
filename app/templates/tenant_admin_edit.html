{% extends "base.html" %}
{% block content %}
<h2>管理者編集</h2>

<form method="post">
  {% if get_csrf %}<input type="hidden" name="csrf_token" value="{{ get_csrf() }}">{% endif %}
  
  <div class="form-group">
    <label for="login_id">ログインID</label>
    <input type="text" id="login_id" name="login_id" value="{{ admin.login_id }}" required>
  </div>
  
  <div class="form-group">
    <label for="name">氏名</label>
    <input type="text" id="name" name="name" value="{{ admin.name }}" required>
  </div>
  
  <div class="form-group">
    <label for="email">メールアドレス</label>
    <input type="email" id="email" name="email" value="{{ admin.email or '' }}" placeholder="例）admin@example.com">
  </div>
  
  <div class="form-group">
    <label for="password">パスワード（変更する場合のみ入力）</label>
    <input type="password" id="password" name="password" placeholder="変更しない場合は空欄">
  </div>
  
  <div class="form-group">
    <label for="password_confirm">パスワード（確認）</label>
    <input type="password" id="password_confirm" name="password_confirm" placeholder="もう一度入力">
  </div>
  
  <div class="form-group">
    <label for="is_owner">
      <input type="checkbox" name="is_owner" value="1" {% if admin.is_owner == 1 %}checked{% endif %} style="margin-right:8px">
      オーナー権限（同じ店舗の他の管理者を編集・削除可能）
    </label>
  </div>
  
  <div class="form-group">
    <label for="stores">管理する店舗 <span style="color:red">*</span></label>
    <div style="border:1px solid #ddd;padding:12px;border-radius:4px;max-height:200px;overflow-y:auto">
      {% if stores %}
        {% for store in stores %}
        <label style="display:block;margin-bottom:8px;cursor:pointer">
          <input type="checkbox" name="store_ids" value="{{ store.id }}" {% if store.id in admin_store_ids %}checked{% endif %} style="margin-right:8px">
          {{ store['名称'] }}
        </label>
        {% endfor %}
      {% else %}
        <p style="color:#999;margin:0">店舗が登録されていません。</p>
      {% endif %}
    </div>
    <small style="color:#666">少なくとも1つの店舗を選択してください。</small>
  </div>
  
  <div class="form-group">
    <label for="active">有効/無効</label>
    <select id="active" name="active">
      <option value="1" {% if admin.active == 1 %}selected{% endif %}>有効</option>
      <option value="0" {% if admin.active == 0 %}selected{% endif %}>無効</option>
    </select>
  </div>
  
  <div class="actions">
    <button type="submit" class="btn">更新</button>
    <a href="{{ url_for('tenant_admin.admins') }}" class="btn sub">キャンセル</a>
  </div>
</form>
{% endblock %}
